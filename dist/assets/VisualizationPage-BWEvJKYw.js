import{t as dt,n as B,a as U,k as vt,r as St,s as Tt,c as zt,b as j}from"./campaignData-BWYJ6KzS.js";import{c as at,P as Et}from"./PhaseDetailView-CozR0jM3.js";import{_ as L}from"./index-Cq6JQ6IN.js";import{f as C,c as b,o as m,h as t,j as gt,n as S,k as y,l as ht,m as mt,u as $t,p as tt,q as I,F as G,s as X,t as r,i as D,v as E,x as ft,y as yt,z as ut,w as _t,A as It,a as R,B as nt,C as Lt,r as Pt}from"./vendor-Clkip-va.js";import{L as z}from"./leaflet-CwTwPtEk.js";import{k as Ct}from"./battlesData-BLmEpcsS.js";const Nt={__name:"SplashScreen",emits:["enter"],setup(s,{emit:i}){const d=i,a=C(!1);function n(){a.value=!0,setTimeout(()=>{d("enter")},1e3)}return(c,p)=>(m(),b("div",{class:S(["splash-screen",{hidden:a.value}])},[t("div",{class:"splash-content"},[p[0]||(p[0]=t("h1",{class:"splash-year"},"1812",-1)),p[1]||(p[1]=t("h2",{class:"splash-title"},"When Napoleon Ventured East",-1)),p[2]||(p[2]=t("p",{class:"splash-subtitle"},[gt(" æ‹¿ç ´ä»‘çš„ä¿„å›½è¿œå¾å¦‚ä½•å°†42ä¸‡å¤§å†›å›¢å˜æˆä¸€å°æ’®å¹¸å­˜è€…"),t("br"),gt(" How the 1812 Patriotic War turned Napoleon's Grand Army into a handful of survivors ")],-1)),t("button",{class:"splash-enter",onClick:n}," å¼€å§‹æ¢ç´¢ / EXPLORE ")]),p[3]||(p[3]=t("div",{class:"splash-scroll-hint"},[t("span",null,"â†“"),t("span",null,"Scroll to explore")],-1)),p[4]||(p[4]=t("div",{class:"splash-bg"},[t("div",{class:"snow-particles"})],-1))],2))}},At=L(Nt,[["__scopeId","data-v-1f3bf4bc"]]),T=C(new Date("1812-06-24")),M={start:new Date("1812-06-24"),end:new Date("1812-12-14")},et=y(()=>{const s=T.value;return s<new Date("1812-09-14")?"advance":s<new Date("1812-10-19")?"occupation":"retreat"}),xt=y(()=>{const s=T.value,i=[...B,...U];let d=i[0],a=1/0;for(const n of i){const c=new Date(n.date),p=Math.abs(c-s);p<a&&(a=p,d=n)}return d.survivors||d.size||0}),Y=y(()=>{const s=T.value;let i=dt[0],d=1/0;for(const a of dt){const n=new Date(a.date),c=Math.abs(n-s);c<d&&(d=c,i=a)}return i.temp});y(()=>{const s=T.value,d=et.value==="retreat"?U:B;let a=d[0],n=1/0;for(const c of d){const p=new Date(c.date),u=Math.abs(p-s);u<n&&(n=u,a=c)}return[a.lat,a.lon]});const Mt=y(()=>{const s=T.value,i=s.getFullYear(),d=s.getMonth()+1,a=s.getDate();return`${i}å¹´${d}æœˆ${a}æ—¥`}),Rt=y(()=>{const s=M.end-M.start,i=T.value-M.start;return Math.max(0,Math.min(100,i/s*100))});function it(s){const i=M.end-M.start,d=new Date(M.start.getTime()+i*(s/100));T.value=d}const W=C(!1),pt=C(1);let st=null;function Bt(){if(W.value)return;W.value=!0;const s=()=>{if(!W.value)return;const i=12*60*60*1e3*pt.value,d=new Date(T.value.getTime()+i);if(d>=M.end){T.value=M.end,ot();return}T.value=d,st=requestAnimationFrame(s)};st=requestAnimationFrame(s)}function ot(){W.value=!1,st&&(cancelAnimationFrame(st),st=null)}function wt(){W.value?ot():Bt()}function kt(){ot(),T.value=M.start}y(()=>{const s=T.value,i=3*24*60*60*1e3;return vt.filter(d=>{const a=new Date(d.date);return Math.abs(a-s)<i})});const qt={class:"map-section"},Vt={__name:"MapView",props:{currentChapter:Object,showAdvance:Boolean,showRetreat:Boolean,showSchwarzenberg:Boolean},emits:["event-click"],setup(s,{expose:i,emit:d}){const a=$t(),n=s,c=d,p=C(null);let u=null,g={advance:[],retreat:[],schwarzenberg:null,markers:[],cities:[],progressMarker:null};const k=y(()=>Y.value<0),x=y(()=>Y.value>=0?0:Math.min(.5,Math.abs(Y.value)/60));ht(()=>{N()}),mt(()=>{u&&u.remove()});function N(){u=z.map(p.value,{center:[55,30],zoom:5,minZoom:4,maxZoom:10,zoomControl:!0,attributionControl:!1}),z.tileLayer("https://{s}.basemaps.cartocdn.com/dark_nolabels/{z}/{x}/{y}{r}.png",{subdomains:"abcd",maxZoom:19}).addTo(u),K(),q(),Q(),Z(),H(),O()}function K(){St.forEach(e=>{z.polyline(e.coords,{color:"#4A90D9",weight:2,opacity:.4,dashArray:"5, 5"}).addTo(u)})}function q(){var h;const e=B[0].survivors;for(let f=0;f<B.length-1;f++){const w=B[f],o=B[f+1],l=Math.max(2,w.survivors/e*12),_=z.polyline([[w.lat,w.lon],[o.lat,o.lon]],{color:"#D4A373",weight:l,opacity:.85,lineCap:"round",lineJoin:"round",className:"animated-path advance-path"}).addTo(u);(h=_.getElement())==null||h.classList.add("flow-animation"),g.advance.push(_)}V()}function V(){const e=z.divIcon({className:"progress-marker",html:'<div class="marker-pulse"></div><div class="marker-dot"></div>',iconSize:[30,30],iconAnchor:[15,15]});g.progressMarker=z.marker([B[0].lat,B[0].lon],{icon:e,zIndexOffset:1e3}).addTo(u)}function J(){if(!g.progressMarker)return;const e=T.value,f=et.value==="retreat"?U:B;let w=f[0],o=f[1]||f[0];for(let A=0;A<f.length-1;A++){const Dt=new Date(f[A].date),bt=new Date(f[A+1].date);if(e>=Dt&&e<=bt){w=f[A],o=f[A+1];break}else e>bt&&(w=f[A+1],o=f[A+2]||f[A+1])}const l=new Date(w.date),_=new Date(o.date),F=_>l?(e-l)/(_-l):0,P=w.lat+(o.lat-w.lat)*Math.min(1,Math.max(0,F)),lt=w.lon+(o.lon-w.lon)*Math.min(1,Math.max(0,F));g.progressMarker.setLatLng([P,lt])}function Q(){const e=U[0].survivors;for(let h=0;h<U.length-1;h++){const f=U[h],w=U[h+1],o=Math.max(1.5,f.survivors/e*8),l=z.polyline([[f.lat,f.lon],[w.lat,w.lon]],{color:"#2D2D2D",weight:o,opacity:.9,lineCap:"round",lineJoin:"round"}).addTo(u);g.retreat.push(l)}}function Z(){const e=Tt.map(f=>[f.lat,f.lon]);g.schwarzenberg=z.polyline(e,{color:"#2A9D8F",weight:3,opacity:.7,dashArray:"10, 5",lineCap:"round"}).addTo(u),[{name:"å› ç§‘æ²ƒæˆ˜å½¹",location:[52.5,26],date:"1812å¹´8æœˆ8æ—¥"},{name:"æˆˆç½—æ°å¥‡è¯ºæˆ˜å½¹",location:[52.2,27.5],date:"1812å¹´8æœˆ12æ—¥"}].forEach(f=>{const w=z.divIcon({className:"event-marker schwarzenberg-battle",html:'<span style="font-size: 18px; cursor: pointer;">âš”ï¸</span>',iconSize:[24,24],iconAnchor:[12,12]}),o=z.marker(f.location,{icon:w}).addTo(u).on("click",()=>{c("event-click",{name:f.name,date:f.date,location:f.location,type:"battle",description:"æ–½ç“¦å²‘è´æ ¼å¥¥åœ°åˆ©è¾…åŠ©å†›å›¢ï¼ˆçº¦34000äººï¼‰åœ¨å—ç¿¼çš„æˆ˜å½¹ã€‚"})});o.bindTooltip(f.name,{permanent:!1,direction:"top",className:"event-tooltip"}),g.markers.push(o)})}function H(){zt.forEach(e=>{const h=z.divIcon({className:"city-marker",html:`<span>${e.name}</span>`,iconSize:null}),f=z.marker([e.lat,e.lon],{icon:h}).addTo(u);g.cities.push(f)})}function O(){vt.forEach(e=>{let h="ğŸ“";switch(e.type){case"battle":h="âš”ï¸";break;case"cold":h="â„ï¸";break;case"city":h="ğŸ›ï¸";break;case"start":h="ğŸš©";break;case"end":h="ğŸ";break;case"retreat":h="â†©ï¸";break;case"disaster":h="ğŸ”¥";break;case"event":h="ğŸ‘¤";break}const f=$(e),w=!!f,o=z.divIcon({className:"event-marker"+(w?" clickable-battle":""),html:`<span style="font-size: 22px; cursor: pointer;">${h}</span>`,iconSize:[30,30],iconAnchor:[15,15]}),l=z.marker(e.location,{icon:o}).addTo(u).on("click",()=>{w?a.push(`/battle/${f.id}`):c("event-click",e)});l.bindTooltip(e.name+(w?" (ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…)":""),{permanent:!1,direction:"top",className:"event-tooltip"}),g.markers.push(l)})}function $(e){if(e.type!=="battle")return null;const h=e.name.toLowerCase(),f=e.name;return Ct.find(w=>{w.title.toLowerCase();const o=w.titleEn.toLowerCase();if(f.includes(w.title.replace("æˆ˜å½¹","").replace("æ”»åŸæˆ˜","").replace("æ¸¡æ²³æˆ˜","").replace("é­é‡æˆ˜","").replace("é˜»å‡»æˆ˜",""))||h.includes(o.replace("battle of ","").replace(" (august)","").replace(" (november)","")))return!0;if(w.location&&e.location){const l=Math.abs(w.location.lat-e.location[0]),_=Math.abs(w.location.lon-e.location[1]);if(l<.5&&_<.5)return!0}return!1})}function v(e,h=6){u&&u.flyTo(e,h,{duration:1.5})}return tt(()=>n.showAdvance,e=>{g.advance.forEach(h=>{h.setStyle({opacity:e?.85:0})})}),tt(()=>n.showRetreat,e=>{g.retreat.forEach(h=>{h.setStyle({opacity:e?.9:0})})}),tt(()=>n.showSchwarzenberg,e=>{g.schwarzenberg&&g.schwarzenberg.setStyle({opacity:e?.7:0})}),tt(T,()=>{if(J(),u&&g.progressMarker){const e=g.progressMarker.getLatLng();u.getCenter().distanceTo(e)>5e4&&u.panTo(e,{duration:.5,animate:!0})}},{immediate:!0}),i({flyTo:v,updateProgressMarker:J}),(e,h)=>(m(),b("div",qt,[t("div",{id:"map",ref_key:"mapContainer",ref:p},null,512),t("div",{class:S(["frost-overlay",{active:k.value}]),style:I({opacity:x.value})},null,6)]))}},Ft=L(Vt,[["__scopeId","data-v-bad88b45"]]),Gt={class:"chapter-nav"},Ot=["onClick"],jt={class:"nav-tooltip"},Ut={__name:"ChapterNav",props:{chapters:Array,currentIndex:Number},emits:["navigate"],setup(s){return(i,d)=>(m(),b("nav",Gt,[(m(!0),b(G,null,X(s.chapters,(a,n)=>(m(),b("div",{key:a.id,class:S(["nav-dot",{active:n===s.currentIndex}]),onClick:c=>i.$emit("navigate",n)},[t("span",jt,r(a.number)+". "+r(a.title),1)],10,Ot))),128))]))}},Xt=L(Ut,[["__scopeId","data-v-3b496452"]]),Wt=["data-chapter"],Jt={class:"chapter-number"},Zt={class:"chapter-title"},Ht={key:0,class:"chapter-date"},Yt={class:"chapter-text"},Kt={key:1,class:"quote-block"},Qt={class:"quote-text"},te={class:"quote-source"},ee={key:2,class:"chapter-stats"},se={key:0,class:"stat-item"},ae={class:"stat-value troops"},ne={key:1,class:"stat-item"},oe={class:"stat-value loss"},le={key:2,class:"stat-item"},ie={class:"stat-value cold"},re={key:3,class:"stat-item"},ce={style:{display:"flex",gap:"20px"}},de={class:"stat-value troops"},ue={class:"stat-value",style:{color:"#E74C3C"}},pe={__name:"ChapterSection",props:{chapter:Object,index:Number},emits:["in-view"],setup(s,{emit:i}){const d=s,a=i,n=C(null),c=C(!1);let p=null;ht(()=>{p=new IntersectionObserver(([g])=>{c.value=g.isIntersecting,g.isIntersecting&&g.intersectionRatio>.3&&a("in-view",d.chapter.id)},{threshold:[.3,.5,.7]}),n.value&&p.observe(n.value)}),mt(()=>{p&&p.disconnect()});function u(g){return g>=1e3?(g/1e3).toFixed(0)+"k":g.toLocaleString()}return(g,k)=>(m(),b("section",{class:"chapter","data-chapter":s.chapter.id,ref_key:"sectionRef",ref:n},[t("div",{class:S(["chapter-content",{"animate-in":c.value}])},[t("span",Jt,r(s.chapter.number)+" / "+r(s.chapter.titleEn),1),t("h2",Zt,r(s.chapter.title),1),s.chapter.date?(m(),b("p",Ht,r(s.chapter.date),1)):D("",!0),t("p",Yt,r(s.chapter.content),1),s.chapter.quote?(m(),b("div",Kt,[t("p",Qt,'"'+r(s.chapter.quote.text)+'"',1),t("p",te,"â€” "+r(s.chapter.quote.source),1)])):D("",!0),s.chapter.stats?(m(),b("div",ee,[s.chapter.stats.troops?(m(),b("div",se,[t("span",ae,r(u(s.chapter.stats.troops)),1),k[0]||(k[0]=t("span",{class:"stat-label"},"å…µåŠ›",-1))])):D("",!0),s.chapter.stats.casualties?(m(),b("div",ne,[t("span",oe,r(u(s.chapter.stats.casualties)),1),k[1]||(k[1]=t("span",{class:"stat-label"},"ä¼¤äº¡",-1))])):D("",!0),s.chapter.stats.temp!==void 0&&s.chapter.stats.temp!==null?(m(),b("div",le,[t("span",ie,r(s.chapter.stats.temp)+"Â°C",1),k[2]||(k[2]=t("span",{class:"stat-label"},"æ¸©åº¦",-1))])):D("",!0),s.chapter.stats.french&&s.chapter.stats.russian?(m(),b("div",re,[t("div",ce,[t("div",null,[t("span",de,r(u(s.chapter.stats.french)),1),k[3]||(k[3]=t("span",{class:"stat-label"},"æ³•å†›",-1))]),t("div",null,[t("span",ue,r(u(s.chapter.stats.russian)),1),k[4]||(k[4]=t("span",{class:"stat-label"},"ä¿„å†›",-1))])])])):D("",!0)])):D("",!0)],2)],8,Wt))}},ve=L(pe,[["__scopeId","data-v-3e65247f"]]),he={class:"status-item"},me={class:"status-value date"},fe={class:"status-item"},be={class:"status-value troops"},ge={key:0,class:"status-item"},we={class:"phase-text"},ke={__name:"StatusPanel",props:{date:String,troops:Number,temp:[Number,null],useGlobalState:{type:Boolean,default:!0}},setup(s){const i=s,d=y(()=>i.useGlobalState?Mt.value:i.date),a=y(()=>i.useGlobalState?xt.value:i.troops),n=y(()=>i.useGlobalState?Y.value:i.temp),c=y(()=>et.value),p=y(()=>{switch(et.value){case"advance":return"è¿›æ”»ä¸­";case"occupation":return"å é¢†è«æ–¯ç§‘";case"retreat":return"æ’¤é€€ä¸­";default:return""}});function u(g){return g?g.toLocaleString():"--"}return(g,k)=>(m(),b("div",{class:S(["status-panel",c.value])},[t("div",he,[k[0]||(k[0]=t("span",{class:"status-label"},"æ—¥æœŸ",-1)),t("span",me,r(d.value),1)]),t("div",fe,[k[1]||(k[1]=t("span",{class:"status-label"},"å…µåŠ›",-1)),t("span",be,r(u(a.value)),1)]),n.value!==null?(m(),b("div",ge,[k[2]||(k[2]=t("span",{class:"status-label"},"æ¸©åº¦",-1)),t("span",{class:S(["status-value temp",{cold:n.value<0,extreme:n.value<-20}])},r(n.value)+"Â°C ",3)])):D("",!0),t("div",{class:S(["phase-indicator",E(et)])},[k[3]||(k[3]=t("span",{class:"phase-dot"},null,-1)),t("span",we,r(p.value),1)],2)],2))}},$e=L(ke,[["__scopeId","data-v-abe5594f"]]),ye={class:"collapse-btn"},_e={class:"legend-content"},Ce={class:"legend-item clickable"},xe=["checked"],Me={class:"legend-item clickable"},De=["checked"],Se={class:"legend-item clickable"},Te=["checked"],ze={__name:"MapLegend",props:{showAdvance:Boolean,showRetreat:Boolean,showSchwarzenberg:Boolean},emits:["update:showAdvance","update:showRetreat","update:showSchwarzenberg"],setup(s){const i=C(!1);return(d,a)=>(m(),b("div",{class:S(["map-legend",{collapsed:i.value}])},[t("div",{class:"legend-header",onClick:a[0]||(a[0]=n=>i.value=!i.value)},[a[4]||(a[4]=t("h4",{class:"legend-title"},"å›¾ä¾‹ / Legend",-1)),t("span",ye,r(i.value?"â€º":"â€¹"),1)]),ft(t("div",_e,[t("label",Ce,[t("input",{type:"checkbox",checked:s.showAdvance,onChange:a[1]||(a[1]=n=>d.$emit("update:showAdvance",n.target.checked))},null,40,xe),a[5]||(a[5]=t("span",{class:"legend-line advance"},null,-1)),a[6]||(a[6]=t("span",null,"è¿›æ”»è·¯çº¿ / Advance",-1))]),t("label",Me,[t("input",{type:"checkbox",checked:s.showRetreat,onChange:a[2]||(a[2]=n=>d.$emit("update:showRetreat",n.target.checked))},null,40,De),a[7]||(a[7]=t("span",{class:"legend-line retreat"},null,-1)),a[8]||(a[8]=t("span",null,"æ’¤é€€è·¯çº¿ / Retreat",-1))]),t("label",Se,[t("input",{type:"checkbox",checked:s.showSchwarzenberg,onChange:a[3]||(a[3]=n=>d.$emit("update:showSchwarzenberg",n.target.checked))},null,40,Te),a[9]||(a[9]=t("span",{class:"legend-line schwarzenberg"},null,-1)),a[10]||(a[10]=t("span",null,"æ–½ç“¦å²‘è´æ ¼å†›å›¢",-1))]),a[11]||(a[11]=ut('<div class="legend-divider" data-v-9a4cc35f></div><div class="legend-item" data-v-9a4cc35f><span class="legend-icon" data-v-9a4cc35f>âš”ï¸</span><span data-v-9a4cc35f>é‡å¤§æˆ˜å½¹ / Battle</span></div><div class="legend-item" data-v-9a4cc35f><span class="legend-icon" data-v-9a4cc35f>â„ï¸</span><span data-v-9a4cc35f>æå¯’äº‹ä»¶ / Frost</span></div><div class="legend-item" data-v-9a4cc35f><span class="legend-icon" data-v-9a4cc35f>ğŸ›ï¸</span><span data-v-9a4cc35f>é‡è¦åŸå¸‚ / City</span></div>',4))],512),[[yt,!i.value]])],2))}},Ee=L(ze,[["__scopeId","data-v-9a4cc35f"]]),Ie={class:"timeline-controller"},Le={class:"phase-controller"},Pe=["onClick"],Ne={class:"phase-label"},Ae={class:"timeline-slider-container"},Re=["title","onClick"],Be={class:"handle-tooltip"},qe={class:"tooltip-date"},Ve={class:"tooltip-troops"},Fe={class:"timeline-ticks"},Ge={class:"tick-label"},Oe={class:"playback-controls"},je=["title"],Ue={class:"speed-control"},Xe={__name:"TimelineController",emits:["event-click","phase-change"],setup(s,{emit:i}){const d=i,a=C(null),n=C(!1),c=C(pt.value),p=[{id:"advance",label:"è¿›æ”»",start:"1812-06-24",end:"1812-09-13",width:45,color:"#D4A373"},{id:"occupation",label:"è«æ–¯ç§‘",start:"1812-09-14",end:"1812-10-18",width:15,color:"#C0392B"},{id:"retreat",label:"æ’¤é€€",start:"1812-10-19",end:"1812-12-14",width:40,color:"#4A90D9"}],u=y(()=>{const $=T.value;for(const v of p){const e=new Date(v.start),h=new Date(v.end);if($>=e&&$<=h)return v.id}return"advance"}),g=y(()=>Rt.value),k=y(()=>Mt.value),x=y(()=>{const $=xt.value;return $>=1e4?Math.round($/1e3)+"k":$.toLocaleString()}),N=y(()=>{const $=[{date:"1812-06-24",label:"6æœˆ"},{date:"1812-07-15",label:"7æœˆ"},{date:"1812-08-15",label:"8æœˆ"},{date:"1812-09-15",label:"9æœˆ"},{date:"1812-10-15",label:"10æœˆ"},{date:"1812-11-15",label:"11æœˆ"},{date:"1812-12-14",label:"12æœˆ"}],v=M.end-M.start;return $.map(e=>({...e,position:(new Date(e.date)-M.start)/v*100}))}),K=y(()=>{const $=M.end-M.start;return vt.filter(v=>v.type==="battle"||v.type==="city"||v.type==="disaster").map(v=>({...v,position:(new Date(v.date)-M.start)/$*100}))}),q=y(()=>({background:`linear-gradient(to right, ${dt.map((v,e)=>{const h=M.end-M.start,f=(new Date(v.date)-M.start)/h*100,w=v.temp<0?Math.min(1,Math.abs(v.temp)/40):0;return`${v.temp<0?`rgba(74, 144, 217, ${w*.5})`:`rgba(212, 163, 115, ${(25-v.temp)/50*.3})`} ${f}%`}).join(", ")})`}));function V($){return T.value>new Date($.end)}function J($){const v=T.value,e=new Date($.start),h=new Date($.end);return v<e?0:v>h?100:(v-e)/(h-e)*100}function Q($){const v=new Date($.start),e=M.end-M.start,h=(v-M.start)/e*100;it(h),d("phase-change",$.id)}function Z(){pt.value=c.value}function H($){$.preventDefault(),n.value=!0,ot();const v=h=>{if(!n.value||!a.value)return;const f=a.value.getBoundingClientRect(),o=(h.touches?h.touches[0].clientX:h.clientX)-f.left,l=Math.max(0,Math.min(100,o/f.width*100));it(l)},e=()=>{n.value=!1,document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",e),document.removeEventListener("touchmove",v),document.removeEventListener("touchend",e)};document.addEventListener("mousemove",v),document.addEventListener("mouseup",e),document.addEventListener("touchmove",v),document.addEventListener("touchend",e)}function O($){if(!a.value)return;const v=a.value.getBoundingClientRect(),e=$.clientX-v.left,h=Math.max(0,Math.min(100,e/v.width*100));it(h)}return($,v)=>(m(),b("div",Ie,[t("div",Le,[(m(),b(G,null,X(p,e=>t("div",{key:e.id,class:S(["phase-segment",{active:u.value===e.id,completed:V(e)}]),style:I({width:e.width+"%"}),onClick:h=>Q(e)},[t("div",{class:"phase-fill",style:I({width:J(e)+"%"})},null,4),t("span",Ne,r(e.label),1)],14,Pe)),64))]),t("div",Ae,[t("div",{class:"timeline-track",ref_key:"trackRef",ref:a,onClick:O},[t("div",{class:"temp-gradient",style:I(q.value)},null,4),(m(!0),b(G,null,X(K.value,e=>(m(),b("div",{key:e.id,class:S(["event-marker-small",e.type]),style:I({left:e.position+"%"}),title:e.name,onClick:_t(h=>$.$emit("event-click",e),["stop"])},[...v[3]||(v[3]=[t("span",{class:"event-dot"},null,-1)])],14,Re))),128)),t("div",{class:"progress-bar",style:I({width:g.value+"%"})},null,4),t("div",{class:"slider-handle",style:I({left:g.value+"%"}),onMousedown:H,onTouchstart:H},[t("div",Be,[t("span",qe,r(k.value),1),t("span",Ve,r(x.value),1),t("span",{class:S(["tooltip-temp",{cold:E(Y)<0}])},r(E(Y))+"Â°C",3)])],36)],512),t("div",Fe,[(m(!0),b(G,null,X(N.value,e=>(m(),b("div",{key:e.date,class:"tick",style:I({left:e.position+"%"})},[t("span",Ge,r(e.label),1)],4))),128))])]),t("div",Oe,[t("button",{class:"control-btn",onClick:v[0]||(v[0]=(...e)=>E(kt)&&E(kt)(...e)),title:"é‡ç½®"},[...v[4]||(v[4]=[t("span",null,"â®",-1)])]),t("button",{class:"control-btn play-btn",onClick:v[1]||(v[1]=(...e)=>E(wt)&&E(wt)(...e)),title:E(W)?"æš‚åœ":"æ’­æ”¾"},[t("span",null,r(E(W)?"â¸":"â–¶"),1)],8,je),t("div",Ue,[v[6]||(v[6]=t("span",{class:"speed-label"},"é€Ÿåº¦",-1)),ft(t("select",{"onUpdate:modelValue":v[2]||(v[2]=e=>c.value=e),onChange:Z},[...v[5]||(v[5]=[t("option",{value:.5},"0.5x",-1),t("option",{value:1},"1x",-1),t("option",{value:2},"2x",-1),t("option",{value:4},"4x",-1)])],544),[[It,c.value,void 0,{number:!0}]])])])]))}},We=L(Xe,[["__scopeId","data-v-92191233"]]),Je={class:"card-type"},Ze={class:"card-body"},He={class:"card-title"},Ye={class:"card-subtitle"},Ke={class:"card-date"},Qe={class:"card-description"},ts={key:0,class:"card-quote"},es={class:"card-quote-text"},ss={class:"card-quote-source"},as={class:"card-stats"},ns={key:0,class:"card-stat"},os={class:"card-stat-value troops"},ls={key:1,class:"card-stat"},is={class:"card-stat-value loss"},rs={key:2,class:"card-stat"},cs={class:"card-stat-value temp"},ds={__name:"EventModal",props:{event:Object},emits:["close"],setup(s){function i(a){return{battle:"æˆ˜å½¹",city:"åŸå¸‚",cold:"æå¯’",start:"å¼€å§‹",end:"ç»“æŸ",retreat:"æ’¤é€€",disaster:"ç¾éš¾",event:"äº‹ä»¶"}[a]||a}function d(a){return a.toLocaleString()}return(a,n)=>(m(),b("div",{class:S(["event-modal-overlay",{active:s.event}]),onClick:n[1]||(n[1]=_t(c=>a.$emit("close"),["self"]))},[t("div",{class:S(["event-card",{active:s.event}])},[t("button",{class:"card-close",onClick:n[0]||(n[0]=c=>a.$emit("close"))},"Ã—"),t("div",{class:"card-image",style:I({backgroundImage:s.event.image?`url(${s.event.image})`:"linear-gradient(135deg, #5D4E37 0%, #8B7355 100%)"})},[t("span",Je,r(i(s.event.type)),1)],4),t("div",Ze,[t("h3",He,r(s.event.name),1),t("p",Ye,r(s.event.nameEn),1),t("p",Ke,r(s.event.date),1),t("p",Qe,r(s.event.description),1),s.event.quote?(m(),b("div",ts,[t("p",es,'"'+r(s.event.quote.text)+'"',1),t("p",ss,"â€” "+r(s.event.quote.source),1)])):D("",!0),t("div",as,[s.event.troops?(m(),b("div",ns,[t("span",os,r(d(s.event.troops)),1),n[2]||(n[2]=t("span",{class:"card-stat-label"},"å…µåŠ›",-1))])):D("",!0),s.event.casualties?(m(),b("div",ls,[t("span",is,r(d(s.event.casualties)),1),n[3]||(n[3]=t("span",{class:"card-stat-label"},"ä¼¤äº¡",-1))])):D("",!0),s.event.temp!==void 0&&s.event.temp!==null?(m(),b("div",rs,[t("span",cs,r(s.event.temp)+"Â°C",1),n[4]||(n[4]=t("span",{class:"card-stat-label"},"æ¸©åº¦",-1))])):D("",!0)])])],2)],2))}},us=L(ds,[["__scopeId","data-v-abde2b3e"]]),ps={class:"collapse-btn"},vs={class:"panel-content"},hs={class:"comparison-bar"},ms={class:"comparison-label"},fs={class:"comparison-value"},bs={class:"comparison-track"},gs={class:"comparison-bar"},ws={class:"comparison-label"},ks={class:"comparison-value"},$s={class:"comparison-track"},ys={class:"comparison-stats"},_s={class:"stat-row"},Cs={class:"stat-percent loss"},xs={class:"stat-row"},Ms={class:"stat-percent safe"},Ds={key:0,class:"comparison-insight"},rt=422e3,ct=3e4,Ss={__name:"ComparisonPanel",props:{currentTroops:{type:Number,default:422e3},phase:String},setup(s){const i=C(!1),d=s,a=y(()=>d.phase==="retreat"?28e3:29e3),n=y(()=>Math.round(d.currentTroops/rt*100)),c=y(()=>Math.round(a.value/ct*100)),p=y(()=>Math.round((rt-d.currentTroops)/rt*100)),u=y(()=>Math.round((ct-a.value)/ct*100));function g(k){return k>=1e3?(k/1e3).toFixed(0)+"k":k.toLocaleString()}return(k,x)=>(m(),b("div",{class:S(["comparison-panel",{collapsed:i.value}])},[t("div",{class:"panel-header",onClick:x[0]||(x[0]=N=>i.value=!i.value)},[x[1]||(x[1]=t("h4",{class:"comparison-title"},"å…µåŠ›å¯¹æ¯” / Force Comparison",-1)),t("span",ps,r(i.value?"â€¹":"â€º"),1)]),ft(t("div",vs,[t("div",hs,[t("div",ms,[x[2]||(x[2]=t("span",null,"æ‹¿ç ´ä»‘ä¸»åŠ›",-1)),t("span",fs,r(g(s.currentTroops)),1)]),t("div",bs,[t("div",{class:"comparison-fill advance",style:I({width:n.value+"%"})},null,4)])]),t("div",gs,[t("div",ws,[x[3]||(x[3]=t("span",null,"æ–½ç“¦å²‘è´æ ¼å†›å›¢",-1)),t("span",ks,r(g(a.value)),1)]),t("div",$s,[t("div",{class:"comparison-fill schwarzenberg",style:I({width:c.value+"%"})},null,4)])]),t("div",ys,[t("div",_s,[x[4]||(x[4]=t("span",{class:"stat-name"},"æ‹¿ç ´ä»‘æŸå¤±ç‡",-1)),t("span",Cs,r(p.value)+"%",1)]),t("div",xs,[x[5]||(x[5]=t("span",{class:"stat-name"},"æ–½ç“¦å²‘è´æ ¼æŸå¤±ç‡",-1)),t("span",Ms,r(u.value)+"%",1)])]),s.phase==="retreat"?(m(),b("div",Ds,[...x[6]||(x[6]=[t("p",null,"æ–½ç“¦å²‘è´æ ¼åœ¨å—ç¿¼é‡‡å–äº†ä¿å®ˆæˆ˜æœ¯ï¼Œé¿å…äº†ä¸»åŠ›å†›å›¢é­é‡çš„ç¾éš¾æ€§æŸå¤±ã€‚",-1)])])):D("",!0)],512),[[yt,!i.value]])],2))}},Ts=L(Ss,[["__scopeId","data-v-2d634982"]]),zs={class:"phases-container"},Es={class:"phases-grid"},Is=["onMouseenter","onClick"],Ls={class:"phase-card-content"},Ps={class:"phase-card-number"},Ns={class:"phase-card-title"},As={class:"phase-card-subtitle"},Rs={class:"phase-card-date"},Bs={key:0,class:"phase-card-stats"},qs={key:0,class:"mini-stat"},Vs={class:"mini-stat-value"},Fs={key:1,class:"mini-stat"},Gs={class:"mini-stat-value casualties"},Os={key:2,class:"mini-stat"},js={class:"mini-stat-value temp"},Us={__name:"PhaseCardsGrid",props:{phases:{type:Array,required:!0}},emits:["select"],setup(s){const i=C(null);function d(a){return a>=1e3?Math.round(a/1e3)+"k":a}return(a,n)=>(m(),b("div",zs,[n[5]||(n[5]=t("h2",{class:"phases-title"},"æ¢ç´¢æˆ˜å½¹é˜¶æ®µ",-1)),n[6]||(n[6]=t("p",{class:"phases-subtitle"},"ç‚¹å‡»å¡ç‰‡æ·±å…¥äº†è§£æ¯ä¸ªé˜¶æ®µçš„è¯¦ç»†æ•…äº‹",-1)),t("div",Es,[(m(!0),b(G,null,X(s.phases,(c,p)=>(m(),b("div",{key:c.id,class:S(["phase-card",{active:i.value===p}]),onMouseenter:u=>i.value=p,onMouseleave:n[0]||(n[0]=u=>i.value=null),onClick:u=>a.$emit("select",c,p)},[t("div",{class:"phase-card-bg",style:I({backgroundImage:`url(${c.backgroundImage})`})},null,4),t("div",{class:S(["phase-card-overlay",c.theme])},null,2),t("div",Ls,[t("span",Ps,r(c.number),1),t("h3",Ns,r(c.title),1),t("p",As,r(c.titleEn),1),t("p",Rs,r(c.dateRange),1),c.stats?(m(),b("div",Bs,[c.stats.troops?(m(),b("div",qs,[t("span",Vs,r(d(c.stats.troops)),1),n[1]||(n[1]=t("span",{class:"mini-stat-label"},"å…µåŠ›",-1))])):D("",!0),c.stats.casualties?(m(),b("div",Fs,[t("span",Gs,r(d(c.stats.casualties)),1),n[2]||(n[2]=t("span",{class:"mini-stat-label"},"ä¼¤äº¡",-1))])):D("",!0),c.stats.temp!==void 0?(m(),b("div",Os,[t("span",js,r(c.stats.temp)+"Â°",1),n[3]||(n[3]=t("span",{class:"mini-stat-label"},"æ°”æ¸©",-1))])):D("",!0)])):D("",!0),n[4]||(n[4]=t("div",{class:"phase-card-enter"},[t("span",null,"è¿›å…¥åœºæ™¯"),t("span",{class:"enter-arrow"},"â†’")],-1))])],42,Is))),128))])]))}},Xs=L(Us,[["__scopeId","data-v-9991159e"]]),Ws={class:"battles-container"},Js={class:"battles-grid"},Zs=["onClick"],Hs={key:0,class:"major-badge"},Ys={class:"battle-content"},Ks={class:"battle-title"},Qs={class:"battle-title-en"},ta={class:"battle-date"},ea={class:"battle-overview"},sa={class:"battle-stats"},aa={class:"stat"},na={class:"stat-value french"},oa={class:"stat"},la={class:"stat-value russian"},ia={class:"stat"},ra={class:"stat-value casualty"},ca={__name:"BattleCardsGrid",setup(s){const i=$t(),d=Ct;function a(c){return c?c>=1e3?Math.round(c/1e3)+"k":c.toLocaleString():"-"}function n(c){i.push(`/battle/${c}`)}return(c,p)=>(m(),b("div",Ws,[p[4]||(p[4]=t("h2",{class:"battles-title"},"å…³é”®æˆ˜å½¹",-1)),p[5]||(p[5]=t("p",{class:"battles-subtitle"},"1812å¹´ä¿„å›½æˆ˜å½¹çš„10ä¸ªå†³å®šæ€§æ—¶åˆ»",-1)),t("div",Js,[(m(!0),b(G,null,X(E(d),u=>(m(),b("div",{key:u.id,class:S(["battle-card",u.phase]),onClick:g=>n(u.id)},[t("div",{class:"battle-image",style:I({backgroundImage:`url(${u.image})`})},[t("span",{class:S(["battle-phase-tag",u.phase])},r(u.phase==="advance"?"è¿›æ”»é˜¶æ®µ":"æ’¤é€€é˜¶æ®µ"),3),u.type==="major_battle"?(m(),b("span",Hs,"é‡å¤§æˆ˜å½¹")):D("",!0)],4),t("div",Ys,[t("h3",Ks,r(u.title),1),t("p",Qs,r(u.titleEn),1),t("p",ta,r(u.date),1),t("p",ea,r(u.overview),1),t("div",sa,[t("div",aa,[p[0]||(p[0]=t("span",{class:"stat-label"},"æ³•å†›",-1)),t("span",na,r(a(u.stats.frenchTroops)),1)]),t("div",oa,[p[1]||(p[1]=t("span",{class:"stat-label"},"ä¿„å†›",-1)),t("span",la,r(a(u.stats.russianTroops)),1)]),t("div",ia,[p[2]||(p[2]=t("span",{class:"stat-label"},"ä¼¤äº¡",-1)),t("span",ra,r(a(u.stats.frenchCasualties+(u.stats.russianCasualties||0))),1)])]),p[3]||(p[3]=t("div",{class:"battle-enter"},[t("span",null,"æŸ¥çœ‹è¯¦æƒ…"),t("span",{class:"arrow"},"â†’")],-1))])],10,Zs))),128))])]))}},da=L(ca,[["__scopeId","data-v-246f92d5"]]),ua={id:"visualization-page"},pa={class:"chapter phases-section","data-chapter":"phases"},va={class:"chapter battles-section","data-chapter":"battles"},ha={__name:"VisualizationPage",setup(s){const i=C(!1),d=C(0),a=C(null),n=C(!0),c=C(!0),p=C(!0),u=C(null),g=C(null),k=C(!1),x=C(null),N=C(0),K=y(()=>j.slice(1,-1)),q=y(()=>j[d.value]),V=y(()=>{var l,_,F;const o=q.value;return{date:(o==null?void 0:o.date)||"1812å¹´",troops:((l=o==null?void 0:o.stats)==null?void 0:l.troops)||((_=o==null?void 0:o.stats)==null?void 0:_.initial)||422e3,temp:((F=o==null?void 0:o.stats)==null?void 0:F.temp)??null}}),J=y(()=>{var l;const o=(l=q.value)==null?void 0:l.phase;return o&&["advance","retreat","battle"].includes(o)});function Q(){i.value=!0}function Z(o){const l=j.findIndex(_=>_.id===o);l!==-1&&l!==d.value&&(d.value=l,O(j[l]))}function H(o){d.value=o;const l=j[o],_=document.querySelector(`[data-chapter="${l.id}"]`);_&&_.scrollIntoView({behavior:"smooth"}),O(l)}function O(o){g.value&&o.location&&g.value.flyTo(o.location,o.zoom||6)}function $(o){a.value=o}function v(o){const _={advance:{center:[55,28],zoom:5},occupation:{center:[55.75,37.6],zoom:7},retreat:{center:[54.5,30],zoom:5}}[o];_&&g.value&&g.value.flyTo(_.center,_.zoom)}function e(o,l){x.value=o,N.value=l,k.value=!0}function h(){k.value=!1}function f(o){const l=N.value+o;l>=0&&l<at.length&&(N.value=l,x.value=at[l])}let w=null;return ht(()=>{w=new IntersectionObserver(o=>{o.forEach(l=>{if(l.isIntersecting&&l.intersectionRatio>.5){const _=l.target.dataset.chapter;_&&Z(_)}})},{threshold:[.5]}),setTimeout(()=>{document.querySelectorAll(".chapter").forEach(o=>{w.observe(o)})},100)}),mt(()=>{w&&w.disconnect()}),tt(d,o=>{const l=j[o];l&&g.value&&O(l)}),(o,l)=>{var F;const _=Pt("router-link");return m(),b("div",ua,[R(_,{to:"/",class:"back-home"},{default:Lt(()=>[...l[4]||(l[4]=[t("span",{class:"back-icon"},"â†",-1),t("span",{class:"back-text"},"é¦–é¡µ",-1)])]),_:1}),i.value?(m(),b(G,{key:1},[R(Ft,{ref_key:"mapView",ref:g,"current-chapter":q.value,"show-advance":n.value,"show-retreat":c.value,"show-schwarzenberg":p.value,onEventClick:$},null,8,["current-chapter","show-advance","show-retreat","show-schwarzenberg"]),R(Xt,{chapters:E(j),"current-index":d.value,onNavigate:H},null,8,["chapters","current-index"]),R($e,{date:V.value.date,troops:V.value.troops,temp:V.value.temp},null,8,["date","troops","temp"]),R(Ee,{"show-advance":n.value,"onUpdate:showAdvance":l[0]||(l[0]=P=>n.value=P),"show-retreat":c.value,"onUpdate:showRetreat":l[1]||(l[1]=P=>c.value=P),"show-schwarzenberg":p.value,"onUpdate:showSchwarzenberg":l[2]||(l[2]=P=>p.value=P)},null,8,["show-advance","show-retreat","show-schwarzenberg"]),t("div",{class:"scroll-container",ref_key:"scrollContainer",ref:u},[l[5]||(l[5]=ut('<section class="chapter minard-section" data-chapter="prologue" data-v-8f081e44><div class="minard-content" data-v-8f081e44><span class="chapter-number" data-v-8f081e44>åºç«  / PROLOGUE</span><h2 class="chapter-title" data-v-8f081e44>Minardçš„ç»å…¸å›¾è¡¨</h2><p class="chapter-text" data-v-8f081e44> 1869å¹´ï¼Œé€€ä¼‘çš„æ³•å›½åœŸæœ¨å·¥ç¨‹å¸ˆCharles Joseph Minardç»˜åˆ¶äº†ä¸€å¼ è¢«ç§°ä¸º&quot;æœ‰å²ä»¥æ¥æœ€å¥½çš„ç»Ÿè®¡å›¾è¡¨&quot;ã€‚ è¿™å¼ å›¾è¡¨æµ“ç¼©äº†1812å¹´æ‹¿ç ´ä»‘ä¿„å›½æˆ˜å½¹çš„å…¨éƒ¨æ‚²å‰§â€”â€”42.2ä¸‡å¤§å†›å¦‚ä½•åœ¨197å¤©å†…é”å‡è‡³ä»…å‰©1ä¸‡äººã€‚ </p><img src="https://upload.wikimedia.org/wikipedia/commons/2/29/Minard.png" alt="Minard&#39;s Map" class="minard-image" data-v-8f081e44><p class="chapter-text" data-v-8f081e44> Minardç”¨çº¿æ¡å®½åº¦è¡¨ç¤ºå…µåŠ›ï¼Œç”¨é¢œè‰²åŒºåˆ†è¿›æ”»ä¸æ’¤é€€ï¼Œå¹¶åœ¨ä¸‹æ–¹å åŠ äº†æ¸©åº¦æ›²çº¿ã€‚ æˆ‘ä»¬å°†åœ¨ç°ä»£åœ°å›¾ä¸Šé‡ç°è¿™ä¸€ç»å…¸ï¼Œå¹¶é€šè¿‡å¤šè§†è§’å™äº‹å¸¦ä½ æ·±å…¥äº†è§£è¿™åœºæˆ˜å½¹çš„æ¯ä¸€ä¸ªå…³é”®æ—¶åˆ»ã€‚ </p></div></section>',1)),(m(!0),b(G,null,X(K.value,(P,lt)=>(m(),nt(ve,{key:P.id,chapter:P,index:lt,onInView:Z},null,8,["chapter","index"]))),128)),t("section",pa,[R(Xs,{phases:E(at),onSelect:e},null,8,["phases"])]),t("section",va,[R(da)]),l[6]||(l[6]=ut('<section class="chapter epilogue-section" data-chapter="epilogue" data-v-8f081e44><div class="epilogue-content" data-v-8f081e44><span class="chapter-number" data-v-8f081e44>å°¾å£° / EPILOGUE</span><h2 class="epilogue-title" data-v-8f081e44>é‡å¿ƒçš„ä»£ä»·</h2><p class="chapter-text" data-v-8f081e44> ä¿„ç½—æ–¯å¸å›½çš„æŸå¤±çº¦ä¸º30ä¸‡äººï¼ˆåŒ…æ‹¬æˆ˜æ—¶å¾å¬ï¼‰ã€‚ è€Œå¤§å†›å›¢çš„æŸå¤±ï¼Œæ ¹æ®Minardçš„å›¾è¡¨ï¼Œæ‹¿ç ´ä»‘çš„è®¡åˆ’ä»˜å‡ºäº†è¶…è¿‡40ä¸‡æ¡ç”Ÿå‘½çš„ä»£ä»·ã€‚ </p><div class="epilogue-stats" data-v-8f081e44><div class="epilogue-stat" data-v-8f081e44><div class="epilogue-stat-value" data-v-8f081e44>422,000</div><div class="epilogue-stat-label" data-v-8f081e44>å‡ºå‘æ—¶å…µåŠ›</div></div><div class="epilogue-stat" data-v-8f081e44><div class="epilogue-stat-value" style="color:#C0392B;" data-v-8f081e44>~10,000</div><div class="epilogue-stat-label" data-v-8f081e44>å¹¸å­˜äººæ•°</div></div><div class="epilogue-stat" data-v-8f081e44><div class="epilogue-stat-value" data-v-8f081e44>97.6%</div><div class="epilogue-stat-label" data-v-8f081e44>æŸå¤±ç‡</div></div></div><div class="quote-block" style="max-width:600px;margin:40px auto;" data-v-8f081e44><p class="quote-text" data-v-8f081e44>&quot;å¤§å†›å›¢å·²ä¸å¤å­˜åœ¨ã€‚&quot;</p><p class="quote-source" data-v-8f081e44>â€” è·¯æ˜“-äºšå†å±±å¤§Â·è´å°”è’‚åŸƒï¼Œæˆ˜äº‰éƒ¨é•¿å…¼å‚è°‹é•¿</p></div></div></section><section class="sources-section" data-v-8f081e44><h3 class="sources-title" data-v-8f081e44>å‚è€ƒèµ„æ–™ / Sources</h3><ul class="sources-list" data-v-8f081e44><li data-v-8f081e44>Charles Joseph Minard, Carte figurative (1869)</li><li data-v-8f081e44>Adam Zamoyski, 1812: Napoleon&#39;s Fatal March on Moscow</li><li data-v-8f081e44>Dominic Lieven, Russia Against Napoleon</li><li data-v-8f081e44>TASS: 1812 - When Napoleon Ventured East</li><li data-v-8f081e44>Clausewitz, The Russian Campaign of 1812</li><li data-v-8f081e44>Armand de Caulaincourt, With Napoleon in Russia</li><li data-v-8f081e44>Britannica: Schwarzenberg&#39;s Austrian Corps</li><li data-v-8f081e44>Wikipedia: French invasion of Russia</li></ul></section>',2))],512),R(We,{onEventClick:$,onPhaseChange:v}),a.value?(m(),nt(us,{key:0,event:a.value,onClose:l[3]||(l[3]=P=>a.value=null)},null,8,["event"])):D("",!0),J.value?(m(),nt(Ts,{key:1,"current-troops":V.value.troops,phase:(F=q.value)==null?void 0:F.phase},null,8,["current-troops","phase"])):D("",!0),R(Et,{visible:k.value,phase:x.value,"has-previous":N.value>0,"has-next":N.value<E(at).length-1,onClose:h,onNavigate:f},null,8,["visible","phase","has-previous","has-next"])],64)):(m(),nt(At,{key:0,onEnter:Q}))])}}},$a=L(ha,[["__scopeId","data-v-8f081e44"]]);export{$a as default};
