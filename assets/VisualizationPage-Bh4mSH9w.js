import{t as de,n as B,a as U,k as ve,r as Se,s as Te,c as ze,b as j}from"./campaignData-BWYJ6KzS.js";import{c as ae,P as Ie}from"./PhaseDetailView-C2Yyypxk.js";import{_ as L}from"./index-sRwKBGqk.js";import{f as C,c as g,o as m,h as e,j as be,n as S,k as y,l as he,m as me,u as $e,p as ee,q as E,F as G,s as X,t as r,i as D,v as I,x as fe,y as ye,z as ue,w as _e,A as Ee,a as R,B as ne,C as Le,r as Pe}from"./vendor-Clkip-va.js";import{L as z}from"./leaflet-CwTwPtEk.js";import{k as Ce}from"./battlesData-BLmEpcsS.js";const Ne={__name:"SplashScreen",emits:["enter"],setup(s,{emit:i}){const d=i,a=C(!1);function n(){a.value=!0,setTimeout(()=>{d("enter")},1e3)}return(c,p)=>(m(),g("div",{class:S(["splash-screen",{hidden:a.value}])},[e("div",{class:"splash-content"},[p[0]||(p[0]=e("h1",{class:"splash-year"},"1812",-1)),p[1]||(p[1]=e("h2",{class:"splash-title"},"When Napoleon Ventured East",-1)),p[2]||(p[2]=e("p",{class:"splash-subtitle"},[be(" æ‹¿ç ´ä»‘çš„ä¿„å›½è¿œå¾å¦‚ä½•å°†42ä¸‡å¤§å†›å›¢å˜æˆä¸€å°æ’®å¹¸å­˜è€…"),e("br"),be(" How the 1812 Patriotic War turned Napoleon's Grand Army into a handful of survivors ")],-1)),e("button",{class:"splash-enter",onClick:n}," å¼€å§‹æ¢ç´¢ / EXPLORE ")]),p[3]||(p[3]=e("div",{class:"splash-scroll-hint"},[e("span",null,"â†“"),e("span",null,"Scroll to explore")],-1)),p[4]||(p[4]=e("div",{class:"splash-bg"},[e("div",{class:"snow-particles"})],-1))],2))}},Ae=L(Ne,[["__scopeId","data-v-d5c9889f"]]),T=C(new Date("1812-06-24")),M={start:new Date("1812-06-24"),end:new Date("1812-12-14")},te=y(()=>{const s=T.value;return s<new Date("1812-09-14")?"advance":s<new Date("1812-10-19")?"occupation":"retreat"}),xe=y(()=>{const s=T.value,i=[...B,...U];let d=i[0],a=1/0;for(const n of i){const c=new Date(n.date),p=Math.abs(c-s);p<a&&(a=p,d=n)}return d.survivors||d.size||0}),Y=y(()=>{const s=T.value;let i=de[0],d=1/0;for(const a of de){const n=new Date(a.date),c=Math.abs(n-s);c<d&&(d=c,i=a)}return i.temp});y(()=>{const s=T.value,d=te.value==="retreat"?U:B;let a=d[0],n=1/0;for(const c of d){const p=new Date(c.date),u=Math.abs(p-s);u<n&&(n=u,a=c)}return[a.lat,a.lon]});const Me=y(()=>{const s=T.value,i=s.getFullYear(),d=s.getMonth()+1,a=s.getDate();return`${i}å¹´${d}æœˆ${a}æ—¥`}),Re=y(()=>{const s=M.end-M.start,i=T.value-M.start;return Math.max(0,Math.min(100,i/s*100))});function ie(s){const i=M.end-M.start,d=new Date(M.start.getTime()+i*(s/100));T.value=d}const W=C(!1),pe=C(1);let se=null;function Be(){if(W.value)return;W.value=!0;const s=()=>{if(!W.value)return;const i=12*60*60*1e3*pe.value,d=new Date(T.value.getTime()+i);if(d>=M.end){T.value=M.end,oe();return}T.value=d,se=requestAnimationFrame(s)};se=requestAnimationFrame(s)}function oe(){W.value=!1,se&&(cancelAnimationFrame(se),se=null)}function we(){W.value?oe():Be()}function ke(){oe(),T.value=M.start}y(()=>{const s=T.value,i=3*24*60*60*1e3;return ve.filter(d=>{const a=new Date(d.date);return Math.abs(a-s)<i})});const qe={class:"map-section"},Ve={__name:"MapView",props:{currentChapter:Object,showAdvance:Boolean,showRetreat:Boolean,showSchwarzenberg:Boolean},emits:["event-click"],setup(s,{expose:i,emit:d}){const a=$e(),n=s,c=d,p=C(null);let u=null,b={advance:[],retreat:[],schwarzenberg:null,markers:[],cities:[],progressMarker:null};const k=y(()=>Y.value<0),x=y(()=>Y.value>=0?0:Math.min(.5,Math.abs(Y.value)/60));he(()=>{N()}),me(()=>{u&&u.remove()});function N(){u=z.map(p.value,{center:[55,30],zoom:5,minZoom:4,maxZoom:10,zoomControl:!0,attributionControl:!1}),z.tileLayer("https://{s}.basemaps.cartocdn.com/dark_nolabels/{z}/{x}/{y}{r}.png",{subdomains:"abcd",maxZoom:19}).addTo(u),K(),q(),Q(),Z(),H(),O()}function K(){Se.forEach(t=>{z.polyline(t.coords,{color:"#4A90D9",weight:2,opacity:.4,dashArray:"5, 5"}).addTo(u)})}function q(){var h;const t=B[0].survivors;for(let f=0;f<B.length-1;f++){const w=B[f],o=B[f+1],l=Math.max(2,w.survivors/t*12),_=z.polyline([[w.lat,w.lon],[o.lat,o.lon]],{color:"#D4A373",weight:l,opacity:.85,lineCap:"round",lineJoin:"round",className:"animated-path advance-path"}).addTo(u);(h=_.getElement())==null||h.classList.add("flow-animation"),b.advance.push(_)}V()}function V(){const t=z.divIcon({className:"progress-marker",html:'<div class="marker-pulse"></div><div class="marker-dot"></div>',iconSize:[30,30],iconAnchor:[15,15]});b.progressMarker=z.marker([B[0].lat,B[0].lon],{icon:t,zIndexOffset:1e3}).addTo(u)}function J(){if(!b.progressMarker)return;const t=T.value,f=te.value==="retreat"?U:B;let w=f[0],o=f[1]||f[0];for(let A=0;A<f.length-1;A++){const De=new Date(f[A].date),ge=new Date(f[A+1].date);if(t>=De&&t<=ge){w=f[A],o=f[A+1];break}else t>ge&&(w=f[A+1],o=f[A+2]||f[A+1])}const l=new Date(w.date),_=new Date(o.date),F=_>l?(t-l)/(_-l):0,P=w.lat+(o.lat-w.lat)*Math.min(1,Math.max(0,F)),le=w.lon+(o.lon-w.lon)*Math.min(1,Math.max(0,F));b.progressMarker.setLatLng([P,le])}function Q(){const t=U[0].survivors;for(let h=0;h<U.length-1;h++){const f=U[h],w=U[h+1],o=Math.max(1.5,f.survivors/t*8),l=z.polyline([[f.lat,f.lon],[w.lat,w.lon]],{color:"#2D2D2D",weight:o,opacity:.9,lineCap:"round",lineJoin:"round"}).addTo(u);b.retreat.push(l)}}function Z(){const t=Te.map(f=>[f.lat,f.lon]);b.schwarzenberg=z.polyline(t,{color:"#2A9D8F",weight:3,opacity:.7,dashArray:"10, 5",lineCap:"round"}).addTo(u),[{name:"å› ç§‘æ²ƒæˆ˜å½¹",location:[52.5,26],date:"1812å¹´8æœˆ8æ—¥"},{name:"æˆˆç½—æ°å¥‡è¯ºæˆ˜å½¹",location:[52.2,27.5],date:"1812å¹´8æœˆ12æ—¥"}].forEach(f=>{const w=z.divIcon({className:"event-marker schwarzenberg-battle",html:'<span style="font-size: 18px; cursor: pointer;">âš”ï¸</span>',iconSize:[24,24],iconAnchor:[12,12]}),o=z.marker(f.location,{icon:w}).addTo(u).on("click",()=>{c("event-click",{name:f.name,date:f.date,location:f.location,type:"battle",description:"æ–½ç“¦å²‘è´æ ¼å¥¥åœ°åˆ©è¾…åŠ©å†›å›¢ï¼ˆçº¦34000äººï¼‰åœ¨å—ç¿¼çš„æˆ˜å½¹ã€‚"})});o.bindTooltip(f.name,{permanent:!1,direction:"top",className:"event-tooltip"}),b.markers.push(o)})}function H(){ze.forEach(t=>{const h=z.divIcon({className:"city-marker",html:`<span>${t.name}</span>`,iconSize:null}),f=z.marker([t.lat,t.lon],{icon:h}).addTo(u);b.cities.push(f)})}function O(){ve.forEach(t=>{let h="ğŸ“";switch(t.type){case"battle":h="âš”ï¸";break;case"cold":h="â„ï¸";break;case"city":h="ğŸ›ï¸";break;case"start":h="ğŸš©";break;case"end":h="ğŸ";break;case"retreat":h="â†©ï¸";break;case"disaster":h="ğŸ”¥";break;case"event":h="ğŸ‘¤";break}const f=$(t),w=!!f,o=z.divIcon({className:"event-marker"+(w?" clickable-battle":""),html:`<span style="font-size: 22px; cursor: pointer;">${h}</span>`,iconSize:[30,30],iconAnchor:[15,15]}),l=z.marker(t.location,{icon:o}).addTo(u).on("click",()=>{w?a.push(`/battle/${f.id}`):c("event-click",t)});l.bindTooltip(t.name+(w?" (ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…)":""),{permanent:!1,direction:"top",className:"event-tooltip"}),b.markers.push(l)})}function $(t){if(t.type!=="battle")return null;const h=t.name.toLowerCase(),f=t.name;return Ce.find(w=>{w.title.toLowerCase();const o=w.titleEn.toLowerCase();if(f.includes(w.title.replace("æˆ˜å½¹","").replace("æ”»åŸæˆ˜","").replace("æ¸¡æ²³æˆ˜","").replace("é­é‡æˆ˜","").replace("é˜»å‡»æˆ˜",""))||h.includes(o.replace("battle of ","").replace(" (august)","").replace(" (november)","")))return!0;if(w.location&&t.location){const l=Math.abs(w.location.lat-t.location[0]),_=Math.abs(w.location.lon-t.location[1]);if(l<.5&&_<.5)return!0}return!1})}function v(t,h=6){u&&u.flyTo(t,h,{duration:1.5})}return ee(()=>n.showAdvance,t=>{b.advance.forEach(h=>{h.setStyle({opacity:t?.85:0})})}),ee(()=>n.showRetreat,t=>{b.retreat.forEach(h=>{h.setStyle({opacity:t?.9:0})})}),ee(()=>n.showSchwarzenberg,t=>{b.schwarzenberg&&b.schwarzenberg.setStyle({opacity:t?.7:0})}),ee(T,()=>{if(J(),u&&b.progressMarker){const t=b.progressMarker.getLatLng();u.getCenter().distanceTo(t)>5e4&&u.panTo(t,{duration:.5,animate:!0})}},{immediate:!0}),i({flyTo:v,updateProgressMarker:J}),(t,h)=>(m(),g("div",qe,[e("div",{id:"map",ref_key:"mapContainer",ref:p},null,512),e("div",{class:S(["frost-overlay",{active:k.value}]),style:E({opacity:x.value})},null,6)]))}},Fe=L(Ve,[["__scopeId","data-v-bad88b45"]]),Ge={class:"chapter-nav"},Oe=["onClick"],je={class:"nav-tooltip"},Ue={__name:"ChapterNav",props:{chapters:Array,currentIndex:Number},emits:["navigate"],setup(s){return(i,d)=>(m(),g("nav",Ge,[(m(!0),g(G,null,X(s.chapters,(a,n)=>(m(),g("div",{key:a.id,class:S(["nav-dot",{active:n===s.currentIndex}]),onClick:c=>i.$emit("navigate",n)},[e("span",je,r(a.number)+". "+r(a.title),1)],10,Oe))),128))]))}},Xe=L(Ue,[["__scopeId","data-v-3b496452"]]),We=["data-chapter"],Je={class:"chapter-number"},Ze={class:"chapter-title"},He={key:0,class:"chapter-date"},Ye={class:"chapter-text"},Ke={key:1,class:"quote-block"},Qe={class:"quote-text"},et={class:"quote-source"},tt={key:2,class:"chapter-stats"},st={key:0,class:"stat-item"},at={class:"stat-value troops"},nt={key:1,class:"stat-item"},ot={class:"stat-value loss"},lt={key:2,class:"stat-item"},it={class:"stat-value cold"},rt={key:3,class:"stat-item"},ct={style:{display:"flex",gap:"20px"}},dt={class:"stat-value troops"},ut={class:"stat-value",style:{color:"#E74C3C"}},pt={__name:"ChapterSection",props:{chapter:Object,index:Number},emits:["in-view"],setup(s,{emit:i}){const d=s,a=i,n=C(null),c=C(!1);let p=null;he(()=>{p=new IntersectionObserver(([b])=>{c.value=b.isIntersecting,b.isIntersecting&&b.intersectionRatio>.3&&a("in-view",d.chapter.id)},{threshold:[.3,.5,.7]}),n.value&&p.observe(n.value)}),me(()=>{p&&p.disconnect()});function u(b){return b>=1e3?(b/1e3).toFixed(0)+"k":b.toLocaleString()}return(b,k)=>(m(),g("section",{class:"chapter","data-chapter":s.chapter.id,ref_key:"sectionRef",ref:n},[e("div",{class:S(["chapter-content",{"animate-in":c.value}])},[e("span",Je,r(s.chapter.number)+" / "+r(s.chapter.titleEn),1),e("h2",Ze,r(s.chapter.title),1),s.chapter.date?(m(),g("p",He,r(s.chapter.date),1)):D("",!0),e("p",Ye,r(s.chapter.content),1),s.chapter.quote?(m(),g("div",Ke,[e("p",Qe,'"'+r(s.chapter.quote.text)+'"',1),e("p",et,"â€” "+r(s.chapter.quote.source),1)])):D("",!0),s.chapter.stats?(m(),g("div",tt,[s.chapter.stats.troops?(m(),g("div",st,[e("span",at,r(u(s.chapter.stats.troops)),1),k[0]||(k[0]=e("span",{class:"stat-label"},"å…µåŠ›",-1))])):D("",!0),s.chapter.stats.casualties?(m(),g("div",nt,[e("span",ot,r(u(s.chapter.stats.casualties)),1),k[1]||(k[1]=e("span",{class:"stat-label"},"ä¼¤äº¡",-1))])):D("",!0),s.chapter.stats.temp!==void 0&&s.chapter.stats.temp!==null?(m(),g("div",lt,[e("span",it,r(s.chapter.stats.temp)+"Â°C",1),k[2]||(k[2]=e("span",{class:"stat-label"},"æ¸©åº¦",-1))])):D("",!0),s.chapter.stats.french&&s.chapter.stats.russian?(m(),g("div",rt,[e("div",ct,[e("div",null,[e("span",dt,r(u(s.chapter.stats.french)),1),k[3]||(k[3]=e("span",{class:"stat-label"},"æ³•å†›",-1))]),e("div",null,[e("span",ut,r(u(s.chapter.stats.russian)),1),k[4]||(k[4]=e("span",{class:"stat-label"},"ä¿„å†›",-1))])])])):D("",!0)])):D("",!0)],2)],8,We))}},vt=L(pt,[["__scopeId","data-v-3e65247f"]]),ht={class:"status-item"},mt={class:"status-value date"},ft={class:"status-item"},gt={class:"status-value troops"},bt={key:0,class:"status-item"},wt={class:"phase-text"},kt={__name:"StatusPanel",props:{date:String,troops:Number,temp:[Number,null],useGlobalState:{type:Boolean,default:!0}},setup(s){const i=s,d=y(()=>i.useGlobalState?Me.value:i.date),a=y(()=>i.useGlobalState?xe.value:i.troops),n=y(()=>i.useGlobalState?Y.value:i.temp),c=y(()=>te.value),p=y(()=>{switch(te.value){case"advance":return"è¿›æ”»ä¸­";case"occupation":return"å é¢†è«æ–¯ç§‘";case"retreat":return"æ’¤é€€ä¸­";default:return""}});function u(b){return b?b.toLocaleString():"--"}return(b,k)=>(m(),g("div",{class:S(["status-panel",c.value])},[e("div",ht,[k[0]||(k[0]=e("span",{class:"status-label"},"æ—¥æœŸ",-1)),e("span",mt,r(d.value),1)]),e("div",ft,[k[1]||(k[1]=e("span",{class:"status-label"},"å…µåŠ›",-1)),e("span",gt,r(u(a.value)),1)]),n.value!==null?(m(),g("div",bt,[k[2]||(k[2]=e("span",{class:"status-label"},"æ¸©åº¦",-1)),e("span",{class:S(["status-value temp",{cold:n.value<0,extreme:n.value<-20}])},r(n.value)+"Â°C ",3)])):D("",!0),e("div",{class:S(["phase-indicator",I(te)])},[k[3]||(k[3]=e("span",{class:"phase-dot"},null,-1)),e("span",wt,r(p.value),1)],2)],2))}},$t=L(kt,[["__scopeId","data-v-49f0fb73"]]),yt={class:"collapse-btn"},_t={class:"legend-content"},Ct={class:"legend-item clickable"},xt=["checked"],Mt={class:"legend-item clickable"},Dt=["checked"],St={class:"legend-item clickable"},Tt=["checked"],zt={__name:"MapLegend",props:{showAdvance:Boolean,showRetreat:Boolean,showSchwarzenberg:Boolean},emits:["update:showAdvance","update:showRetreat","update:showSchwarzenberg"],setup(s){const i=C(!1);return(d,a)=>(m(),g("div",{class:S(["map-legend",{collapsed:i.value}])},[e("div",{class:"legend-header",onClick:a[0]||(a[0]=n=>i.value=!i.value)},[a[4]||(a[4]=e("h4",{class:"legend-title"},"å›¾ä¾‹ / Legend",-1)),e("span",yt,r(i.value?"â€º":"â€¹"),1)]),fe(e("div",_t,[e("label",Ct,[e("input",{type:"checkbox",checked:s.showAdvance,onChange:a[1]||(a[1]=n=>d.$emit("update:showAdvance",n.target.checked))},null,40,xt),a[5]||(a[5]=e("span",{class:"legend-line advance"},null,-1)),a[6]||(a[6]=e("span",null,"è¿›æ”»è·¯çº¿ / Advance",-1))]),e("label",Mt,[e("input",{type:"checkbox",checked:s.showRetreat,onChange:a[2]||(a[2]=n=>d.$emit("update:showRetreat",n.target.checked))},null,40,Dt),a[7]||(a[7]=e("span",{class:"legend-line retreat"},null,-1)),a[8]||(a[8]=e("span",null,"æ’¤é€€è·¯çº¿ / Retreat",-1))]),e("label",St,[e("input",{type:"checkbox",checked:s.showSchwarzenberg,onChange:a[3]||(a[3]=n=>d.$emit("update:showSchwarzenberg",n.target.checked))},null,40,Tt),a[9]||(a[9]=e("span",{class:"legend-line schwarzenberg"},null,-1)),a[10]||(a[10]=e("span",null,"æ–½ç“¦å²‘è´æ ¼å†›å›¢",-1))]),a[11]||(a[11]=ue('<div class="legend-divider" data-v-a490e522></div><div class="legend-item" data-v-a490e522><span class="legend-icon" data-v-a490e522>âš”ï¸</span><span data-v-a490e522>é‡å¤§æˆ˜å½¹ / Battle</span></div><div class="legend-item" data-v-a490e522><span class="legend-icon" data-v-a490e522>â„ï¸</span><span data-v-a490e522>æå¯’äº‹ä»¶ / Frost</span></div><div class="legend-item" data-v-a490e522><span class="legend-icon" data-v-a490e522>ğŸ›ï¸</span><span data-v-a490e522>é‡è¦åŸå¸‚ / City</span></div>',4))],512),[[ye,!i.value]])],2))}},It=L(zt,[["__scopeId","data-v-a490e522"]]),Et={class:"timeline-controller"},Lt={class:"phase-controller"},Pt=["onClick"],Nt={class:"phase-label"},At={class:"timeline-slider-container"},Rt=["title","onClick"],Bt={class:"handle-tooltip"},qt={class:"tooltip-date"},Vt={class:"tooltip-troops"},Ft={class:"timeline-ticks"},Gt={class:"tick-label"},Ot={class:"playback-controls"},jt=["title"],Ut={class:"speed-control"},Xt={__name:"TimelineController",emits:["event-click","phase-change"],setup(s,{emit:i}){const d=i,a=C(null),n=C(!1),c=C(pe.value),p=[{id:"advance",label:"è¿›æ”»",start:"1812-06-24",end:"1812-09-13",width:45,color:"#D4A373"},{id:"occupation",label:"è«æ–¯ç§‘",start:"1812-09-14",end:"1812-10-18",width:15,color:"#C0392B"},{id:"retreat",label:"æ’¤é€€",start:"1812-10-19",end:"1812-12-14",width:40,color:"#4A90D9"}],u=y(()=>{const $=T.value;for(const v of p){const t=new Date(v.start),h=new Date(v.end);if($>=t&&$<=h)return v.id}return"advance"}),b=y(()=>Re.value),k=y(()=>Me.value),x=y(()=>{const $=xe.value;return $>=1e4?Math.round($/1e3)+"k":$.toLocaleString()}),N=y(()=>{const $=[{date:"1812-06-24",label:"6æœˆ"},{date:"1812-07-15",label:"7æœˆ"},{date:"1812-08-15",label:"8æœˆ"},{date:"1812-09-15",label:"9æœˆ"},{date:"1812-10-15",label:"10æœˆ"},{date:"1812-11-15",label:"11æœˆ"},{date:"1812-12-14",label:"12æœˆ"}],v=M.end-M.start;return $.map(t=>({...t,position:(new Date(t.date)-M.start)/v*100}))}),K=y(()=>{const $=M.end-M.start;return ve.filter(v=>v.type==="battle"||v.type==="city"||v.type==="disaster").map(v=>({...v,position:(new Date(v.date)-M.start)/$*100}))}),q=y(()=>({background:`linear-gradient(to right, ${de.map((v,t)=>{const h=M.end-M.start,f=(new Date(v.date)-M.start)/h*100,w=v.temp<0?Math.min(1,Math.abs(v.temp)/40):0;return`${v.temp<0?`rgba(74, 144, 217, ${w*.5})`:`rgba(212, 163, 115, ${(25-v.temp)/50*.3})`} ${f}%`}).join(", ")})`}));function V($){return T.value>new Date($.end)}function J($){const v=T.value,t=new Date($.start),h=new Date($.end);return v<t?0:v>h?100:(v-t)/(h-t)*100}function Q($){const v=new Date($.start),t=M.end-M.start,h=(v-M.start)/t*100;ie(h),d("phase-change",$.id)}function Z(){pe.value=c.value}function H($){$.preventDefault(),n.value=!0,oe();const v=h=>{if(!n.value||!a.value)return;const f=a.value.getBoundingClientRect(),o=(h.touches?h.touches[0].clientX:h.clientX)-f.left,l=Math.max(0,Math.min(100,o/f.width*100));ie(l)},t=()=>{n.value=!1,document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",t),document.removeEventListener("touchmove",v),document.removeEventListener("touchend",t)};document.addEventListener("mousemove",v),document.addEventListener("mouseup",t),document.addEventListener("touchmove",v),document.addEventListener("touchend",t)}function O($){if(!a.value)return;const v=a.value.getBoundingClientRect(),t=$.clientX-v.left,h=Math.max(0,Math.min(100,t/v.width*100));ie(h)}return($,v)=>(m(),g("div",Et,[e("div",Lt,[(m(),g(G,null,X(p,t=>e("div",{key:t.id,class:S(["phase-segment",{active:u.value===t.id,completed:V(t)}]),style:E({width:t.width+"%"}),onClick:h=>Q(t)},[e("div",{class:"phase-fill",style:E({width:J(t)+"%"})},null,4),e("span",Nt,r(t.label),1)],14,Pt)),64))]),e("div",At,[e("div",{class:"timeline-track",ref_key:"trackRef",ref:a,onClick:O},[e("div",{class:"temp-gradient",style:E(q.value)},null,4),(m(!0),g(G,null,X(K.value,t=>(m(),g("div",{key:t.id,class:S(["event-marker-small",t.type]),style:E({left:t.position+"%"}),title:t.name,onClick:_e(h=>$.$emit("event-click",t),["stop"])},[...v[3]||(v[3]=[e("span",{class:"event-dot"},null,-1)])],14,Rt))),128)),e("div",{class:"progress-bar",style:E({width:b.value+"%"})},null,4),e("div",{class:"slider-handle",style:E({left:b.value+"%"}),onMousedown:H,onTouchstart:H},[e("div",Bt,[e("span",qt,r(k.value),1),e("span",Vt,r(x.value),1),e("span",{class:S(["tooltip-temp",{cold:I(Y)<0}])},r(I(Y))+"Â°C",3)])],36)],512),e("div",Ft,[(m(!0),g(G,null,X(N.value,t=>(m(),g("div",{key:t.date,class:"tick",style:E({left:t.position+"%"})},[e("span",Gt,r(t.label),1)],4))),128))])]),e("div",Ot,[e("button",{class:"control-btn",onClick:v[0]||(v[0]=(...t)=>I(ke)&&I(ke)(...t)),title:"é‡ç½®"},[...v[4]||(v[4]=[e("span",null,"â®",-1)])]),e("button",{class:"control-btn play-btn",onClick:v[1]||(v[1]=(...t)=>I(we)&&I(we)(...t)),title:I(W)?"æš‚åœ":"æ’­æ”¾"},[e("span",null,r(I(W)?"â¸":"â–¶"),1)],8,jt),e("div",Ut,[v[6]||(v[6]=e("span",{class:"speed-label"},"é€Ÿåº¦",-1)),fe(e("select",{"onUpdate:modelValue":v[2]||(v[2]=t=>c.value=t),onChange:Z},[...v[5]||(v[5]=[e("option",{value:.5},"0.5x",-1),e("option",{value:1},"1x",-1),e("option",{value:2},"2x",-1),e("option",{value:4},"4x",-1)])],544),[[Ee,c.value,void 0,{number:!0}]])])])]))}},Wt=L(Xt,[["__scopeId","data-v-92191233"]]),Jt={class:"card-type"},Zt={class:"card-body"},Ht={class:"card-title"},Yt={class:"card-subtitle"},Kt={class:"card-date"},Qt={class:"card-description"},es={key:0,class:"card-quote"},ts={class:"card-quote-text"},ss={class:"card-quote-source"},as={class:"card-stats"},ns={key:0,class:"card-stat"},os={class:"card-stat-value troops"},ls={key:1,class:"card-stat"},is={class:"card-stat-value loss"},rs={key:2,class:"card-stat"},cs={class:"card-stat-value temp"},ds={__name:"EventModal",props:{event:Object},emits:["close"],setup(s){function i(a){return{battle:"æˆ˜å½¹",city:"åŸå¸‚",cold:"æå¯’",start:"å¼€å§‹",end:"ç»“æŸ",retreat:"æ’¤é€€",disaster:"ç¾éš¾",event:"äº‹ä»¶"}[a]||a}function d(a){return a.toLocaleString()}return(a,n)=>(m(),g("div",{class:S(["event-modal-overlay",{active:s.event}]),onClick:n[1]||(n[1]=_e(c=>a.$emit("close"),["self"]))},[e("div",{class:S(["event-card",{active:s.event}])},[e("button",{class:"card-close",onClick:n[0]||(n[0]=c=>a.$emit("close"))},"Ã—"),e("div",{class:"card-image",style:E({backgroundImage:s.event.image?`url(${s.event.image})`:"linear-gradient(135deg, #5D4E37 0%, #8B7355 100%)"})},[e("span",Jt,r(i(s.event.type)),1)],4),e("div",Zt,[e("h3",Ht,r(s.event.name),1),e("p",Yt,r(s.event.nameEn),1),e("p",Kt,r(s.event.date),1),e("p",Qt,r(s.event.description),1),s.event.quote?(m(),g("div",es,[e("p",ts,'"'+r(s.event.quote.text)+'"',1),e("p",ss,"â€” "+r(s.event.quote.source),1)])):D("",!0),e("div",as,[s.event.troops?(m(),g("div",ns,[e("span",os,r(d(s.event.troops)),1),n[2]||(n[2]=e("span",{class:"card-stat-label"},"å…µåŠ›",-1))])):D("",!0),s.event.casualties?(m(),g("div",ls,[e("span",is,r(d(s.event.casualties)),1),n[3]||(n[3]=e("span",{class:"card-stat-label"},"ä¼¤äº¡",-1))])):D("",!0),s.event.temp!==void 0&&s.event.temp!==null?(m(),g("div",rs,[e("span",cs,r(s.event.temp)+"Â°C",1),n[4]||(n[4]=e("span",{class:"card-stat-label"},"æ¸©åº¦",-1))])):D("",!0)])])],2)],2))}},us=L(ds,[["__scopeId","data-v-abde2b3e"]]),ps={class:"collapse-btn"},vs={class:"panel-content"},hs={class:"comparison-bar"},ms={class:"comparison-label"},fs={class:"comparison-value"},gs={class:"comparison-track"},bs={class:"comparison-bar"},ws={class:"comparison-label"},ks={class:"comparison-value"},$s={class:"comparison-track"},ys={class:"comparison-stats"},_s={class:"stat-row"},Cs={class:"stat-percent loss"},xs={class:"stat-row"},Ms={class:"stat-percent safe"},Ds={key:0,class:"comparison-insight"},re=422e3,ce=3e4,Ss={__name:"ComparisonPanel",props:{currentTroops:{type:Number,default:422e3},phase:String},setup(s){const i=C(!1),d=s,a=y(()=>d.phase==="retreat"?28e3:29e3),n=y(()=>Math.round(d.currentTroops/re*100)),c=y(()=>Math.round(a.value/ce*100)),p=y(()=>Math.round((re-d.currentTroops)/re*100)),u=y(()=>Math.round((ce-a.value)/ce*100));function b(k){return k>=1e3?(k/1e3).toFixed(0)+"k":k.toLocaleString()}return(k,x)=>(m(),g("div",{class:S(["comparison-panel",{collapsed:i.value}])},[e("div",{class:"panel-header",onClick:x[0]||(x[0]=N=>i.value=!i.value)},[x[1]||(x[1]=e("h4",{class:"comparison-title"},"å…µåŠ›å¯¹æ¯” / Force Comparison",-1)),e("span",ps,r(i.value?"â€¹":"â€º"),1)]),fe(e("div",vs,[e("div",hs,[e("div",ms,[x[2]||(x[2]=e("span",null,"æ‹¿ç ´ä»‘ä¸»åŠ›",-1)),e("span",fs,r(b(s.currentTroops)),1)]),e("div",gs,[e("div",{class:"comparison-fill advance",style:E({width:n.value+"%"})},null,4)])]),e("div",bs,[e("div",ws,[x[3]||(x[3]=e("span",null,"æ–½ç“¦å²‘è´æ ¼å†›å›¢",-1)),e("span",ks,r(b(a.value)),1)]),e("div",$s,[e("div",{class:"comparison-fill schwarzenberg",style:E({width:c.value+"%"})},null,4)])]),e("div",ys,[e("div",_s,[x[4]||(x[4]=e("span",{class:"stat-name"},"æ‹¿ç ´ä»‘æŸå¤±ç‡",-1)),e("span",Cs,r(p.value)+"%",1)]),e("div",xs,[x[5]||(x[5]=e("span",{class:"stat-name"},"æ–½ç“¦å²‘è´æ ¼æŸå¤±ç‡",-1)),e("span",Ms,r(u.value)+"%",1)])]),s.phase==="retreat"?(m(),g("div",Ds,[...x[6]||(x[6]=[e("p",null,"æ–½ç“¦å²‘è´æ ¼åœ¨å—ç¿¼é‡‡å–äº†ä¿å®ˆæˆ˜æœ¯ï¼Œé¿å…äº†ä¸»åŠ›å†›å›¢é­é‡çš„ç¾éš¾æ€§æŸå¤±ã€‚",-1)])])):D("",!0)],512),[[ye,!i.value]])],2))}},Ts=L(Ss,[["__scopeId","data-v-2d634982"]]),zs={class:"phases-container"},Is={class:"phases-grid"},Es=["onMouseenter","onClick"],Ls={class:"phase-card-content"},Ps={class:"phase-card-number"},Ns={class:"phase-card-title"},As={class:"phase-card-subtitle"},Rs={class:"phase-card-date"},Bs={key:0,class:"phase-card-stats"},qs={key:0,class:"mini-stat"},Vs={class:"mini-stat-value"},Fs={key:1,class:"mini-stat"},Gs={class:"mini-stat-value casualties"},Os={key:2,class:"mini-stat"},js={class:"mini-stat-value temp"},Us={__name:"PhaseCardsGrid",props:{phases:{type:Array,required:!0}},emits:["select"],setup(s){const i=C(null);function d(a){return a>=1e3?Math.round(a/1e3)+"k":a}return(a,n)=>(m(),g("div",zs,[n[5]||(n[5]=e("h2",{class:"phases-title"},"æ¢ç´¢æˆ˜å½¹é˜¶æ®µ",-1)),n[6]||(n[6]=e("p",{class:"phases-subtitle"},"ç‚¹å‡»å¡ç‰‡æ·±å…¥äº†è§£æ¯ä¸ªé˜¶æ®µçš„è¯¦ç»†æ•…äº‹",-1)),e("div",Is,[(m(!0),g(G,null,X(s.phases,(c,p)=>(m(),g("div",{key:c.id,class:S(["phase-card",{active:i.value===p}]),onMouseenter:u=>i.value=p,onMouseleave:n[0]||(n[0]=u=>i.value=null),onClick:u=>a.$emit("select",c,p)},[e("div",{class:"phase-card-bg",style:E({backgroundImage:`url(${c.backgroundImage})`})},null,4),e("div",{class:S(["phase-card-overlay",c.theme])},null,2),e("div",Ls,[e("span",Ps,r(c.number),1),e("h3",Ns,r(c.title),1),e("p",As,r(c.titleEn),1),e("p",Rs,r(c.dateRange),1),c.stats?(m(),g("div",Bs,[c.stats.troops?(m(),g("div",qs,[e("span",Vs,r(d(c.stats.troops)),1),n[1]||(n[1]=e("span",{class:"mini-stat-label"},"å…µåŠ›",-1))])):D("",!0),c.stats.casualties?(m(),g("div",Fs,[e("span",Gs,r(d(c.stats.casualties)),1),n[2]||(n[2]=e("span",{class:"mini-stat-label"},"ä¼¤äº¡",-1))])):D("",!0),c.stats.temp!==void 0?(m(),g("div",Os,[e("span",js,r(c.stats.temp)+"Â°",1),n[3]||(n[3]=e("span",{class:"mini-stat-label"},"æ°”æ¸©",-1))])):D("",!0)])):D("",!0),n[4]||(n[4]=e("div",{class:"phase-card-enter"},[e("span",null,"è¿›å…¥åœºæ™¯"),e("span",{class:"enter-arrow"},"â†’")],-1))])],42,Es))),128))])]))}},Xs=L(Us,[["__scopeId","data-v-9991159e"]]),Ws={class:"battles-container"},Js={class:"battles-grid"},Zs=["onClick"],Hs={key:0,class:"major-badge"},Ys={class:"battle-content"},Ks={class:"battle-title"},Qs={class:"battle-title-en"},ea={class:"battle-date"},ta={class:"battle-overview"},sa={class:"battle-stats"},aa={class:"stat"},na={class:"stat-value french"},oa={class:"stat"},la={class:"stat-value russian"},ia={class:"stat"},ra={class:"stat-value casualty"},ca={__name:"BattleCardsGrid",setup(s){const i=$e(),d=Ce;function a(c){return c?c>=1e3?Math.round(c/1e3)+"k":c.toLocaleString():"-"}function n(c){i.push(`/battle/${c}`)}return(c,p)=>(m(),g("div",Ws,[p[4]||(p[4]=e("h2",{class:"battles-title"},"å…³é”®æˆ˜å½¹",-1)),p[5]||(p[5]=e("p",{class:"battles-subtitle"},"1812å¹´ä¿„å›½æˆ˜å½¹çš„10ä¸ªå†³å®šæ€§æ—¶åˆ»",-1)),e("div",Js,[(m(!0),g(G,null,X(I(d),u=>(m(),g("div",{key:u.id,class:S(["battle-card",u.phase]),onClick:b=>n(u.id)},[e("div",{class:"battle-image",style:E({backgroundImage:`url(${u.image})`})},[e("span",{class:S(["battle-phase-tag",u.phase])},r(u.phase==="advance"?"è¿›æ”»é˜¶æ®µ":"æ’¤é€€é˜¶æ®µ"),3),u.type==="major_battle"?(m(),g("span",Hs,"é‡å¤§æˆ˜å½¹")):D("",!0)],4),e("div",Ys,[e("h3",Ks,r(u.title),1),e("p",Qs,r(u.titleEn),1),e("p",ea,r(u.date),1),e("p",ta,r(u.overview),1),e("div",sa,[e("div",aa,[p[0]||(p[0]=e("span",{class:"stat-label"},"æ³•å†›",-1)),e("span",na,r(a(u.stats.frenchTroops)),1)]),e("div",oa,[p[1]||(p[1]=e("span",{class:"stat-label"},"ä¿„å†›",-1)),e("span",la,r(a(u.stats.russianTroops)),1)]),e("div",ia,[p[2]||(p[2]=e("span",{class:"stat-label"},"ä¼¤äº¡",-1)),e("span",ra,r(a(u.stats.frenchCasualties+(u.stats.russianCasualties||0))),1)])]),p[3]||(p[3]=e("div",{class:"battle-enter"},[e("span",null,"æŸ¥çœ‹è¯¦æƒ…"),e("span",{class:"arrow"},"â†’")],-1))])],10,Zs))),128))])]))}},da=L(ca,[["__scopeId","data-v-36f1a190"]]),ua={id:"visualization-page"},pa={class:"chapter phases-section","data-chapter":"phases"},va={class:"chapter battles-section","data-chapter":"battles"},ha={__name:"VisualizationPage",setup(s){const i=C(sessionStorage.getItem("splashDismissed")==="true"),d=C(0),a=C(null),n=C(!0),c=C(!0),p=C(!0),u=C(null),b=C(null),k=C(!1),x=C(null),N=C(0),K=y(()=>j.slice(1,-1)),q=y(()=>j[d.value]),V=y(()=>{var l,_,F;const o=q.value;return{date:(o==null?void 0:o.date)||"1812å¹´",troops:((l=o==null?void 0:o.stats)==null?void 0:l.troops)||((_=o==null?void 0:o.stats)==null?void 0:_.initial)||422e3,temp:((F=o==null?void 0:o.stats)==null?void 0:F.temp)??null}}),J=y(()=>{var l;const o=(l=q.value)==null?void 0:l.phase;return o&&["advance","retreat","battle"].includes(o)});function Q(){i.value=!0,sessionStorage.setItem("splashDismissed","true")}function Z(o){const l=j.findIndex(_=>_.id===o);l!==-1&&l!==d.value&&(d.value=l,O(j[l]))}function H(o){d.value=o;const l=j[o],_=document.querySelector(`[data-chapter="${l.id}"]`);_&&_.scrollIntoView({behavior:"smooth"}),O(l)}function O(o){b.value&&o.location&&b.value.flyTo(o.location,o.zoom||6)}function $(o){a.value=o}function v(o){const _={advance:{center:[55,28],zoom:5},occupation:{center:[55.75,37.6],zoom:7},retreat:{center:[54.5,30],zoom:5}}[o];_&&b.value&&b.value.flyTo(_.center,_.zoom)}function t(o,l){x.value=o,N.value=l,k.value=!0}function h(){k.value=!1}function f(o){const l=N.value+o;l>=0&&l<ae.length&&(N.value=l,x.value=ae[l])}let w=null;return he(()=>{w=new IntersectionObserver(o=>{o.forEach(l=>{if(l.isIntersecting&&l.intersectionRatio>.5){const _=l.target.dataset.chapter;_&&Z(_)}})},{threshold:[.5]}),setTimeout(()=>{document.querySelectorAll(".chapter").forEach(o=>{w.observe(o)})},100)}),me(()=>{w&&w.disconnect()}),ee(d,o=>{const l=j[o];l&&b.value&&O(l)}),(o,l)=>{var F;const _=Pe("router-link");return m(),g("div",ua,[R(_,{to:"/",class:"back-home"},{default:Le(()=>[...l[4]||(l[4]=[e("span",{class:"back-icon"},"â†",-1),e("span",{class:"back-text"},"é¦–é¡µ",-1)])]),_:1}),i.value?(m(),g(G,{key:1},[R(Fe,{ref_key:"mapView",ref:b,"current-chapter":q.value,"show-advance":n.value,"show-retreat":c.value,"show-schwarzenberg":p.value,onEventClick:$},null,8,["current-chapter","show-advance","show-retreat","show-schwarzenberg"]),R(Xe,{chapters:I(j),"current-index":d.value,onNavigate:H},null,8,["chapters","current-index"]),R($t,{date:V.value.date,troops:V.value.troops,temp:V.value.temp},null,8,["date","troops","temp"]),R(It,{"show-advance":n.value,"onUpdate:showAdvance":l[0]||(l[0]=P=>n.value=P),"show-retreat":c.value,"onUpdate:showRetreat":l[1]||(l[1]=P=>c.value=P),"show-schwarzenberg":p.value,"onUpdate:showSchwarzenberg":l[2]||(l[2]=P=>p.value=P)},null,8,["show-advance","show-retreat","show-schwarzenberg"]),e("div",{class:"scroll-container",ref_key:"scrollContainer",ref:u},[l[5]||(l[5]=ue('<section class="chapter minard-section" data-chapter="prologue" data-v-8eed7940><div class="minard-content" data-v-8eed7940><span class="chapter-number" data-v-8eed7940>åºç«  / PROLOGUE</span><h2 class="chapter-title" data-v-8eed7940>Minardçš„ç»å…¸å›¾è¡¨</h2><p class="chapter-text" data-v-8eed7940> 1869å¹´ï¼Œé€€ä¼‘çš„æ³•å›½åœŸæœ¨å·¥ç¨‹å¸ˆCharles Joseph Minardç»˜åˆ¶äº†ä¸€å¼ è¢«ç§°ä¸º&quot;æœ‰å²ä»¥æ¥æœ€å¥½çš„ç»Ÿè®¡å›¾è¡¨&quot;ã€‚ è¿™å¼ å›¾è¡¨æµ“ç¼©äº†1812å¹´æ‹¿ç ´ä»‘ä¿„å›½æˆ˜å½¹çš„å…¨éƒ¨æ‚²å‰§â€”â€”42.2ä¸‡å¤§å†›å¦‚ä½•åœ¨197å¤©å†…é”å‡è‡³ä»…å‰©1ä¸‡äººã€‚ </p><img src="https://upload.wikimedia.org/wikipedia/commons/2/29/Minard.png" alt="Minard&#39;s Map" class="minard-image" data-v-8eed7940><p class="chapter-text" data-v-8eed7940> Minardç”¨çº¿æ¡å®½åº¦è¡¨ç¤ºå…µåŠ›ï¼Œç”¨é¢œè‰²åŒºåˆ†è¿›æ”»ä¸æ’¤é€€ï¼Œå¹¶åœ¨ä¸‹æ–¹å åŠ äº†æ¸©åº¦æ›²çº¿ã€‚ æˆ‘ä»¬å°†åœ¨ç°ä»£åœ°å›¾ä¸Šé‡ç°è¿™ä¸€ç»å…¸ï¼Œå¹¶é€šè¿‡å¤šè§†è§’å™äº‹å¸¦ä½ æ·±å…¥äº†è§£è¿™åœºæˆ˜å½¹çš„æ¯ä¸€ä¸ªå…³é”®æ—¶åˆ»ã€‚ </p></div></section>',1)),(m(!0),g(G,null,X(K.value,(P,le)=>(m(),ne(vt,{key:P.id,chapter:P,index:le,onInView:Z},null,8,["chapter","index"]))),128)),e("section",pa,[R(Xs,{phases:I(ae),onSelect:t},null,8,["phases"])]),e("section",va,[R(da)]),l[6]||(l[6]=ue('<section class="chapter epilogue-section" data-chapter="epilogue" data-v-8eed7940><div class="epilogue-content" data-v-8eed7940><span class="chapter-number" data-v-8eed7940>å°¾å£° / EPILOGUE</span><h2 class="epilogue-title" data-v-8eed7940>é‡å¿ƒçš„ä»£ä»·</h2><p class="chapter-text" data-v-8eed7940> ä¿„ç½—æ–¯å¸å›½çš„æŸå¤±çº¦ä¸º30ä¸‡äººï¼ˆåŒ…æ‹¬æˆ˜æ—¶å¾å¬ï¼‰ã€‚ è€Œå¤§å†›å›¢çš„æŸå¤±ï¼Œæ ¹æ®Minardçš„å›¾è¡¨ï¼Œæ‹¿ç ´ä»‘çš„è®¡åˆ’ä»˜å‡ºäº†è¶…è¿‡40ä¸‡æ¡ç”Ÿå‘½çš„ä»£ä»·ã€‚ </p><div class="epilogue-stats" data-v-8eed7940><div class="epilogue-stat" data-v-8eed7940><div class="epilogue-stat-value" data-v-8eed7940>422,000</div><div class="epilogue-stat-label" data-v-8eed7940>å‡ºå‘æ—¶å…µåŠ›</div></div><div class="epilogue-stat" data-v-8eed7940><div class="epilogue-stat-value" style="color:#C0392B;" data-v-8eed7940>~10,000</div><div class="epilogue-stat-label" data-v-8eed7940>å¹¸å­˜äººæ•°</div></div><div class="epilogue-stat" data-v-8eed7940><div class="epilogue-stat-value" data-v-8eed7940>97.6%</div><div class="epilogue-stat-label" data-v-8eed7940>æŸå¤±ç‡</div></div></div><div class="quote-block" style="max-width:600px;margin:40px auto;" data-v-8eed7940><p class="quote-text" data-v-8eed7940>&quot;å¤§å†›å›¢å·²ä¸å¤å­˜åœ¨ã€‚&quot;</p><p class="quote-source" data-v-8eed7940>â€” è·¯æ˜“-äºšå†å±±å¤§Â·è´å°”è’‚åŸƒï¼Œæˆ˜äº‰éƒ¨é•¿å…¼å‚è°‹é•¿</p></div></div></section><section class="sources-section" data-v-8eed7940><h3 class="sources-title" data-v-8eed7940>å‚è€ƒèµ„æ–™ / Sources</h3><ul class="sources-list" data-v-8eed7940><li data-v-8eed7940>Charles Joseph Minard, Carte figurative (1869)</li><li data-v-8eed7940>Adam Zamoyski, 1812: Napoleon&#39;s Fatal March on Moscow</li><li data-v-8eed7940>Dominic Lieven, Russia Against Napoleon</li><li data-v-8eed7940>TASS: 1812 - When Napoleon Ventured East</li><li data-v-8eed7940>Clausewitz, The Russian Campaign of 1812</li><li data-v-8eed7940>Armand de Caulaincourt, With Napoleon in Russia</li><li data-v-8eed7940>Britannica: Schwarzenberg&#39;s Austrian Corps</li><li data-v-8eed7940>Wikipedia: French invasion of Russia</li></ul></section>',2))],512),R(Wt,{onEventClick:$,onPhaseChange:v}),a.value?(m(),ne(us,{key:0,event:a.value,onClose:l[3]||(l[3]=P=>a.value=null)},null,8,["event"])):D("",!0),J.value?(m(),ne(Ts,{key:1,"current-troops":V.value.troops,phase:(F=q.value)==null?void 0:F.phase},null,8,["current-troops","phase"])):D("",!0),R(Ie,{visible:k.value,phase:x.value,"has-previous":N.value>0,"has-next":N.value<I(ae).length-1,onClose:h,onNavigate:f},null,8,["visible","phase","has-previous","has-next"])],64)):(m(),ne(Ae,{key:0,onEnter:Q}))])}}},$a=L(ha,[["__scopeId","data-v-8eed7940"]]);export{$a as default};
